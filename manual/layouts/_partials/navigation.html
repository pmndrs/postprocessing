<nav class="navigation">
	<div id="search"></div>
	<ul>

		{{ $currentPage := . }}
		{{ range $menuEntry := .Site.Params.sidebarMenus }}

			{{ $menuName := $menuEntry.name }}
			{{ $active := false }}
			{{ $menu := index $.Site.Menus $menuName }}

			{{ range $menu }}
				{{ if .HasChildren }}
					{{ $active = (or $active ($currentPage.HasMenuCurrent $menuName .)) }}
				{{ else }}
					{{ $active = (or $active ($currentPage.IsMenuCurrent $menuName .)) }}
				{{ end }}
			{{ end }}

			{{ $expanded := (or $menuEntry.expanded $active) }}

			{{ $class := slice $menuName }}
			{{ if $active }}
				{{ $class = $class | append "active" }}
			{{ end }}
			{{ if $expanded }}
				{{ $class = $class | append "expanded" }}
			{{ end }}

			<li class="menu {{ delimit $class ` ` }}" data-id="{{ $menuName }}">
				<h2>{{ i18n $menuName . }}</h2>
				{{ partial "menu.html" (dict "currentPage" $currentPage "menu" $menu "menuName" $menuName ) }}
			</li>

		{{ end }}

	</ul>
</nav>
